<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ØªÙØ¹ÙŠÙ„ - Falcon Town</title>
<link rel="icon" href="logo.webp">
<style>
  /* ===== Palette: Ø¨Ù†ÙŠ Ã— Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ ===== */
  :root{
    --bg-dark:#1c120f;
    --bg-mid:#2f1f18;
    --card: rgba(255,255,255,0.03);
    --accent:#ff8a29;
    --accent-2:#ffb36b;
    --muted:#cbb9a1;
    --text:#f6efe8;
    --glass: rgba(255,255,255,0.03);
    --radius:14px;
    --shadow: 0 18px 60px rgba(0,0,0,0.6);
    font-family: "Cairo", "Segoe UI", Tahoma, system-ui, sans-serif;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:
    radial-gradient(900px 400px at 10% 10%, rgba(255,138,41,0.03), transparent),
    linear-gradient(180deg,var(--bg-dark) 0%, var(--bg-mid) 100%);
    color:var(--text);-webkit-font-smoothing:antialiased;}
  a{color:inherit}
  .container{max-width:1150px;margin:26px auto;padding:18px;}

  /* header */
  header{display:flex;align-items:center;gap:16px;padding:12px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:16px;box-shadow:var(--shadow);border:1px solid rgba(255,255,255,0.02);position:relative;z-index:10}
  .logo{width:88px;height:88px;border-radius:12px;overflow:hidden;background:linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.45));display:flex;align-items:center;justify-content:center;border:1px solid rgba(255,255,255,0.03)}
  .logo img{width:100%;height:100%;object-fit:cover;display:block}
  .brand{flex:1}
  .brand h1{margin:0;font-size:20px;letter-spacing:1px}
  .brand p{margin:0;color:var(--muted);font-size:13px}

  /* nav */
  nav{display:flex;gap:8px;flex-wrap:wrap}
  .nav-btn{padding:10px 14px;border-radius:10px;background:transparent;border:1px solid transparent;color:var(--text);cursor:pointer;font-weight:700;transition:all .25s;box-shadow:0 6px 20px rgba(0,0,0,0.35)}
  .nav-btn:hover{transform:translateY(-6px);box-shadow:0 18px 50px rgba(0,0,0,0.55)}
  .nav-btn.active{background:linear-gradient(90deg, rgba(255,138,41,0.12), rgba(255,138,41,0.06));border:1px solid rgba(255,138,41,0.12);color:var(--accent)}

  /* layout */
  main{margin-top:18px;display:grid;grid-template-columns:1fr 360px;gap:18px;align-items:start}
  .card{background:var(--card);border-radius:16px;padding:20px;box-shadow:var(--shadow);border:1px solid rgba(255,255,255,0.02)}
  .hero{padding:26px;min-height:320px;position:relative;overflow:hidden}

  /* sections */
  .section{display:none;opacity:0;transform:translateY(14px);transition:all .45s cubic-bezier(.2,.9,.3,1)}
  .section.active{display:block;opacity:1;transform:none}

  h2{margin:0 0 8px;color:var(--accent);font-size:20px}
  .muted{color:var(--muted);font-size:13px}
  .content{line-height:1.7;color:var(--text)}

  /* form */
  label{display:block;margin-top:12px;font-weight:700;font-size:13px;color:var(--muted)}
  input[type="text"], input[type="number"], textarea{
    width:100%;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.36));color:var(--text);box-sizing:border-box;font-size:14px;margin-top:8px;outline:none;transition:box-shadow .12s, transform .12s;
  }
  input:focus, textarea:focus{box-shadow:0 8px 32px rgba(255,138,41,0.06);transform:translateY(-3px)}
  textarea{min-height:120px;resize:vertical}
  .btn{display:inline-block;padding:11px 18px;border-radius:12px;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#111;font-weight:800;border:none;cursor:pointer;margin-top:14px;box-shadow:0 18px 50px rgba(255,138,41,0.12);transition:transform .18s, box-shadow .18s}
  .btn:hover{transform:translateY(-6px) scale(1.02)}
  .btn:active{transform:translateY(-2px)}

  /* right column */
  .side{position:sticky;top:24px}
  .rules-list{list-style:none;padding:0;margin:0}
  .rules-list li{padding:12px;border-radius:12px;margin-bottom:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.04));border:1px solid rgba(255,255,255,0.02)}

  /* welcome overlay */
  .welcome-overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(10,6,4,0.98), rgba(10,6,4,0.94));z-index:9999;backdrop-filter: blur(4px)}
  .welcome-box{width:92%;max-width:900px;padding:34px;border-radius:18px;text-align:center;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 30px 100px rgba(0,0,0,0.7);border:1px solid rgba(255,255,255,0.02);position:relative;overflow:hidden}
  .welcome-logo{width:140px;height:140px;border-radius:18px;overflow:hidden;margin:0 auto 12px;border:6px solid rgba(255,138,41,0.06);display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--accent),var(--accent-2))}
  .welcome-logo img{width:90%;height:90%;object-fit:contain;display:block}
  .welcome-box h1{font-size:30px;margin:6px 0;color:var(--accent);letter-spacing:1px}
  .welcome-sub{color:var(--muted);margin-bottom:14px}
  .enter-btn{margin-top:12px;padding:12px 20px;border-radius:12px;border:none;background:linear-gradient(90deg,var(--accent),var(--accent-2));font-weight:800;color:#111;cursor:pointer;box-shadow:0 20px 60px rgba(255,138,41,0.12);transition:transform .18s}
  .enter-btn:hover{transform:translateY(-6px);filter:brightness(1.02)}

  /* logo animation */
  .logo-spin{animation:spin 6s linear infinite}
  @keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

  /* small-screen */
  @media (max-width:980px){
    main{grid-template-columns:1fr; padding-bottom:40px}
    .side{position:relative;top:0}
    header{flex-direction:column;gap:10px}
    .welcome-box{padding:22px}
  }
  @media (max-width:420px){
    .welcome-box h1{font-size:22px}
    header h1{font-size:18px}
  }

  /* decorative glows & particles */
  .glow{position:absolute;border-radius:50%;filter:blur(36px);opacity:0.12;pointer-events:none}
  .glow.g1{width:420px;height:420px;background:radial-gradient(circle at 30% 30%, rgba(255,138,41,0.16), transparent);left:-120px;top:-120px}
  .glow.g2{width:360px;height:360px;background:radial-gradient(circle at 70% 70%, rgba(255,180,110,0.12), transparent);right:-90px;bottom:-100px}
</style>
</head>
<body>

<div class="welcome-overlay" id="welcome">
  <div class="welcome-box">
    <div class="welcome-logo logo-spin" aria-hidden="true">
      <img src="logo.webp" alt="Falcon Town Logo">
    </div>
    <h1>Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ ØªÙØ¹ÙŠÙ„ â€” Falcon Town</h1>
    <p class="welcome-sub">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø±Ø³Ù…ÙŠØ© â€” Ø§Ø¶ØºØ· Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©</p>
    <div style="display:flex;gap:12px;justify-content:center;align-items:center;margin-top:8px">
      <button class="enter-btn" id="enterSite">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
      <button class="enter-btn" id="muteBtn" style="background:transparent;color:var(--accent);border:1px solid rgba(255,138,41,0.12)">ÙƒØªÙ… Ø§Ù„Ø£ØµÙˆØ§Øª</button>
    </div>
  </div>
</div>

<div class="container">
  <header>
    <div class="logo" aria-hidden="true"><img src="logo.webp" alt="logo"></div>
    <div class="brand">
      <h1>ØªÙØ¹ÙŠÙ„ - Falcon Town</h1>
      <p class="muted">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø±Ø³Ù…ÙŠØ© â€” ØµÙ…Ù…Ù‡Ø§ ÙƒØ§ÙØ­ Ø§Ù„Ù…ÙƒØ§ÙØ­</p>
      <nav style="margin-top:10px">
        <button class="nav-btn active" data-target="home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <button class="nav-btn" data-target="rules">Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„ØªÙØ¹ÙŠÙ„</button>
        <button class="nav-btn" data-target="apply">Ø·Ù„Ø¨ Ø§Ù„ØªÙØ¹ÙŠÙ„</button>
      </nav>
    </div>
  </header>

  <main>
    <section class="card hero section active" id="home">
      <div class="glow g1"></div>
      <div class="glow g2"></div>
      <h2>Ù…Ø±Ø­Ø¨Ù‹Ø§ ÙÙŠ Falcon Town</h2>
      <p class="muted">Ù‡Ù†Ø§ ØªØ¬Ø¯ ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ Ù„ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨Ùƒ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±.</p>
      <div style="margin-top:16px" class="content">
        <p>Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ø¹Ù„Ø§Ù‡ Ù„Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† ÙˆÙ†Ù…ÙˆØ°Ø¬ Ø·Ù„Ø¨ Ø§Ù„ØªÙØ¹ÙŠÙ„.</p>
        <p style="margin-top:12px;color:var(--muted)">Ù…Ø¤Ø«Ø±Ø§Øª ØµÙˆØªÙŠØ© ÙˆØ­Ø±ÙƒØ§Øª Ø¹Ù†Ø¯ Ø§Ù„ØªÙ†Ù‚Ù„ â€” Ø¬Ø±Ø¨Ù‡Ø§ Ø§Ù„Ø¢Ù†!</p>
      </div>
    </section>

    <aside class="card side" style="min-height:120px">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <strong>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø³Ø±ÙŠØ¹Ø©</strong>
          <div class="muted" style="font-size:13px">Falcon Town</div>
        </div>
        <div style="text-align:left">
          <label style="font-size:13px;color:var(--muted)">Ø§Ù„Ø£ØµÙˆØ§Øª
            <input id="soundToggle" type="checkbox" checked style="margin-left:8px;transform:scale(1.1)">
          </label>
        </div>
      </div>

      <ul class="rules-list" style="margin-top:14px">
        <li>ğŸ“œ Ø§Ù„Ø§Ø³ØªØ¦Ù†Ø§Ù Ù…ØªØ§Ø­ Ø®Ù„Ø§Ù„ 72 Ø³Ø§Ø¹Ø©.</li>
        <li>ğŸ•˜ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„: 08:00 - 20:00 (ÙˆÙ‚Øª Ø§Ù„Ø³ÙŠØ±ÙØ±).</li>
        <li>ğŸ“¢ ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± Ù‚Ù†Ø§Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙÙŠ Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯.</li>
      </ul>
    </aside>

    <section class="card section" id="rules">
      <h2>Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„ØªÙØ¹ÙŠÙ„</h2>
      <div class="content muted" style="margin-top:10px">
        <ol>
          <li>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙÙŠ Ø§Ù„Ø·Ù„Ø¨.</li>
          <li>ÙŠØ¬Ø¨ Ø°ÙƒØ± Ø³Ø¨Ø¨ Ù…Ù‚Ù†Ø¹ Ù„Ù„ØªÙØ¹ÙŠÙ„ â€” Ø§Ù„Ø·Ù„Ø¨Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ù‚Ù†Ø¹Ø© Ø³ØªÙØ±ÙØ¶.</li>
          <li>Ù„Ø§ ØªÙƒØ±Ø§Ø± ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨ Ø£ÙƒØ«Ø± Ù…Ù† Ù…Ø±Ø© ÙƒÙ„ 48 Ø³Ø§Ø¹Ø©.</li>
          <li>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ØªØ­ØªÙØ¸ Ø¨Ø§Ù„Ø­Ù‚ ÙÙŠ Ù‚Ø¨ÙˆÙ„ Ø£Ùˆ Ø±ÙØ¶ Ø£ÙŠ Ø·Ù„Ø¨.</li>
        </ol>
      </div>
    </section>

    <section class="card section" id="apply">
      <h2>Ø·Ù„Ø¨ ØªÙØ¹ÙŠÙ„</h2>
      <p class="muted">Ø§Ù…Ù„Ø£ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø£Ø¯Ù†Ø§Ù‡ Ø¨Ø¯Ù‚Ø© â€” ÙŠØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¹Ù„Ù‰ Ø´ÙƒÙ„ Embed Ø¥Ù„Ù‰ Ù‚Ù†Ø§Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.</p>
      <form id="activationForm" style="margin-top:14px">
        <label>Ø§Ø³Ù…Ùƒ ÙÙŠ Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯</label>
        <input type="text" name="user" placeholder="Ù…Ø«Ø§Ù„: Player#1234" required>

        <label>Ø¹Ù…Ø±Ùƒ</label>
        <input type="number" name="age" placeholder="Ù…Ø«Ø§Ù„: 18" required>

        <label>Ø³Ø¨Ø¨ ØªÙØ¹ÙŠÙ„Ùƒ</label>
        <textarea name="reason" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¨Ø¨ Ù…Ù‚Ù†Ø¹ Ù‡Ù†Ø§..." required></textarea>
        <small style="display:block;color:var(--muted);margin-top:6px">Ø³Ø¨Ø¨ Ù…Ù‚Ù†Ø¹</small>

        <button class="btn" type="submit">Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªÙØ¹ÙŠÙ„</button>
        <div id="formStatus" class="muted" style="margin-top:10px"></div>
      </form>
    </section>
  </main>

  <footer style="margin-top:20px;text-align:center;color:var(--muted);font-size:13px">ØµÙ†Ø¹ Ø¨ÙˆØ§Ø³Ø·Ø© <strong>ÙƒØ§ÙØ­ Ø§Ù„Ù…ÙƒØ§ÙØ­</strong> â€” Falcon Town</footer>
</div>

<script>
/* ===========================
   ØµÙˆØªÙŠØ§Øª: WebAudio-based
   =========================== */
let audioEnabled = true;
const soundToggle = document.getElementById('soundToggle');
const muteBtn = document.getElementById('muteBtn');

soundToggle.addEventListener('change', e=> audioEnabled = e.target.checked);
muteBtn && muteBtn.addEventListener('click', ()=> {
  audioEnabled = !audioEnabled;
  soundToggle.checked = audioEnabled;
  // Ø¨ØµÙˆØª Ù‚ØµÙŠØ± ÙŠØ°ÙƒØ± Ø­Ø§Ù„Ø©
  microBeep(audioEnabled ? 880 : 200, 0.06);
});

/* create audio context and helper */
function _audioCtx(){
  return window.__audioCtx || (window.__audioCtx = new (window.AudioContext || window.webkitAudioContext)());
}
function playOsc(freq, type='sine', dur=0.08, gain=0.07){
  if(!audioEnabled) return;
  try{
    const ctx = _audioCtx();
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    o.type = type; o.frequency.value = freq;
    g.gain.value = gain;
    o.connect(g); g.connect(ctx.destination);
    o.start();
    g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + dur);
    setTimeout(()=>{ try{ o.stop(); }catch(e){} }, dur*1000 + 12);
  }catch(e){}
}

/* small effects */
function microBeep(f=720,d=0.04){ playOsc(f,'triangle',d,0.04) }
function clickSound(){ playOsc(760,'triangle',0.045,0.04) }
function navSound(){ playOsc(420,'sine',0.12,0.09) }
function successSound(){ playOsc(320,'sine',0.18,0.12); setTimeout(()=>playOsc(900,'sine',0.08,0.05),120) }
function errorSound(){ playOsc(160,'sawtooth',0.18,0.12); setTimeout(()=>playOsc(220,'sawtooth',0.12,0.06),150) }

/* ===========================
   Navigation & UI behaviors
   =========================== */
const navBtns = document.querySelectorAll('.nav-btn');
const sections = document.querySelectorAll('.section');
navBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const target = btn.dataset.target;
    // update active class
    navBtns.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    // show section
    sections.forEach(s=>{
      if(s.id === target){ s.classList.add('active'); } else { s.classList.remove('active'); }
    });
    navSound();
  });
});

/* welcome enter behavior */
const welcome = document.getElementById('welcome');
const enterBtn = document.getElementById('enterSite');
enterBtn.addEventListener('click', ()=>{
  // small animation: fade out overlay
  welcome.style.transition = 'opacity .6s, transform .6s';
  welcome.style.opacity = 0;
  welcome.style.transform = 'scale(.98) translateY(10px)';
  setTimeout(()=> welcome.remove(), 650);
  // sound
  successSound();
  // reveal home section
  document.querySelectorAll('.section').forEach(s=> s.classList.remove('active'));
  document.getElementById('home').classList.add('active');
  // focus first interactive element
  setTimeout(()=> { const el = document.querySelector('nav .nav-btn.active'); if(el) el.focus(); }, 700);
});

/* auto-hide welcome after 7s if not clicked */
setTimeout(()=> {
  if(document.getElementById('welcome')) {
    document.getElementById('welcome').style.opacity = 0;
    setTimeout(()=> { const el = document.getElementById('welcome'); if(el) el.remove(); }, 700);
  }
}, 7000);

/* small hover/click sound for buttons */
document.addEventListener('pointerdown', e=>{
  const t = e.target;
  if(t.closest('.nav-btn') || t.closest('.btn') || t.closest('.enter-btn')) clickSound();
});

/* keyboard accessibility for nav */
navBtns.forEach(b=> b.addEventListener('keyup', (e)=> { if(e.key==='Enter' || e.key===' ') b.click(); }));

/* ==========================================================
   Form handling & Webhook (ØªÙ… ØªØ­Ø¯ÙŠØ« Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ù‡Ù†Ø§)
   ========================================================== */
/* ğŸ”‘ ØªÙ… ØªØ­Ø¯ÙŠØ« Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ù‡Ù†Ø§: */
const WEBHOOK_URL = "https://discord.com/api/webhooks/1436062603578179757/2BH7CzqNGMI9qe7zAQxYx9Qh1GNvNAFpHsYXOshGJJlJE7qtJsq68ZGauLhZWfanbYmt";

/**
 * Ø¯Ø§Ù„Ø© Ø¨Ø³ÙŠØ·Ø© Ù„ØªÙ‡Ø±ÙŠØ¨ (Escape) Ø§Ù„Ù†ØµÙˆØµ Ù…Ù† HTML Ù„ØªØ¬Ù†Ø¨ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø¹Ø±Ø¶.
 * @param {string} s Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø±Ø§Ø¯ ØªÙ‡Ø±ÙŠØ¨Ù‡.
 */
function escapeHtml(s){ 
  return (s+"").replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); 
}

/**
 * ØªØ±Ø³Ù„ Ø·Ù„Ø¨ Ø§Ù„Ù€ Embed Ø¥Ù„Ù‰ Webhook Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ø±ÙˆÙƒØ³ÙŠ Ù„ØªØ¬Ø§ÙˆØ² CORS.
 * @param {object} embed Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù€ Embed.
 */
async function sendEmbed(embed){
  // ğŸ”‘ Ø§Ù„Ø­Ù„ Ù„Ù…Ø´ÙƒÙ„Ø© CORS: Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù†Ø·Ø§Ù‚ Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ø¨Ù†Ø·Ø§Ù‚ Ø¨Ø±ÙˆÙƒØ³ÙŠ Ù…ÙˆØ«ÙˆÙ‚ Ø¨Ù‡
  const CORS_PROXY_DOMAIN = 'webhook.lewisakura.moe';
  
  // ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ 'discord.com' Ø£Ùˆ 'discordapp.com' Ø¨Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ
  const finalEndpoint = WEBHOOK_URL.replace(/(discord\.com|discordapp\.com)/, CORS_PROXY_DOMAIN);

  try{
    const res = await fetch(finalEndpoint, {
      method:'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({embeds:[embed]})
    });
    
    // ÙŠØ¬Ø¨ ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù…Ù† Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ/Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
    if(!res.ok) {
        let errorBody = await res.text();
        console.error('Webhook Error Response:', errorBody);
        throw new Error(`Failed with status ${res.status}. Response: ${errorBody.substring(0, 100)}...`);
    }
    
    return {ok:true};
  }catch(err){
    console.warn('send failed (CORS likely solved, check network/proxy status)', err);
    return {ok:false, error:err.message};
  }
}

document.getElementById('activationForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const status = document.getElementById('formStatus');
  status.textContent = "Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨..."; navSound();
  const form = new FormData(e.target);
  const f = Object.fromEntries(form.entries());
  
  // ØªØ­Ù‚Ù‚ Ø¨Ø³ÙŠØ· Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
  if(!f.user || !f.age || !f.reason){
     status.textContent = "Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© âš ï¸";
     errorSound();
     return;
  }
  
  // build embed
  const embed = {
    title: `Ø·Ù„Ø¨ ØªÙØ¹ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ â€” ${f.user || 'â€”'}`,
    color: 15158332, // Ù„ÙˆÙ† Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ/Ø°Ù‡Ø¨ÙŠ
    fields: [
      { name: "ğŸ‘¤ Ø§Ù„Ø§Ø³Ù… ÙÙŠ Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯", value: escapeHtml(f.user) || "â€”", inline:true },
      { name: "ğŸ‚ Ø§Ù„Ø¹Ù…Ø±", value: escapeHtml(f.age) || "â€”", inline:true },
      { name: "ğŸ“ Ø³Ø¨Ø¨ Ø§Ù„ØªÙØ¹ÙŠÙ„", value: escapeHtml(f.reason) || "â€”", inline:false }
    ],
    timestamp: new Date().toISOString(),
    footer: { text: "ØªÙØ¹ÙŠÙ„ - Falcon Town" }
  };
  
  const result = await sendEmbed(embed);
  
  if(result.ok){
    status.textContent = "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­ âœ…";
    successSound();
    e.target.reset(); // ØªÙØ±ÙŠØº Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
  } else {
    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ø£ÙƒØ«Ø± ØªÙØµÙŠÙ„Ø§Ù‹ ÙÙŠ Ø­Ø§Ù„Ø© ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ø£ÙŠ Ø³Ø¨Ø¨ Ø¢Ø®Ø± (Ù…Ø«Ù„ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ù†ÙØ³Ù‡)
    status.innerHTML = 'ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ø£Ùˆ Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ). Ø§Ù„Ø±Ø³Ø§Ù„Ø©: ' + escapeHtml(result.error);
    errorSound();
  }
});

/* On load: make sure home is active */
window.addEventListener('load', ()=>{
  document.querySelectorAll('.section').forEach(s=> s.classList.remove('active'));
  document.getElementById('home').classList.add('active');
  // random gentle micro beep to show UI alive (short)
  setTimeout(()=> microBeep(660,0.03), 400);
});
</script>
</body>
</html>
  .brand p{margin:0;color:var(--muted);font-size:13px}

  /* nav */
  nav{display:flex;gap:8px;flex-wrap:wrap}
  .nav-btn{padding:10px 14px;border-radius:10px;background:transparent;border:1px solid transparent;color:var(--text);cursor:pointer;font-weight:700;transition:all .25s;box-shadow:0 6px 20px rgba(0,0,0,0.35)}
  .nav-btn:hover{transform:translateY(-6px);box-shadow:0 18px 50px rgba(0,0,0,0.55)}
  .nav-btn.active{background:linear-gradient(90deg, rgba(255,138,41,0.12), rgba(255,138,41,0.06));border:1px solid rgba(255,138,41,0.12);color:var(--accent)}

  /* layout */
  main{margin-top:18px;display:grid;grid-template-columns:1fr 360px;gap:18px;align-items:start}
  .card{background:var(--card);border-radius:16px;padding:20px;box-shadow:var(--shadow);border:1px solid rgba(255,255,255,0.02)}
  .hero{padding:26px;min-height:320px;position:relative;overflow:hidden}

  /* sections */
  .section{display:none;opacity:0;transform:translateY(14px);transition:all .45s cubic-bezier(.2,.9,.3,1)}
  .section.active{display:block;opacity:1;transform:none}

  h2{margin:0 0 8px;color:var(--accent);font-size:20px}
  .muted{color:var(--muted);font-size:13px}
  .content{line-height:1.7;color:var(--text)}

  /* form */
  label{display:block;margin-top:12px;font-weight:700;font-size:13px;color:var(--muted)}
  input[type="text"], input[type="number"], textarea{
    width:100%;padding:12px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:linear-gradient(180deg, rgba(0,0,0,0.25), rgba(0,0,0,0.36));color:var(--text);box-sizing:border-box;font-size:14px;margin-top:8px;outline:none;transition:box-shadow .12s, transform .12s;
  }
  input:focus, textarea:focus{box-shadow:0 8px 32px rgba(255,138,41,0.06);transform:translateY(-3px)}
  textarea{min-height:120px;resize:vertical}
  .btn{display:inline-block;padding:11px 18px;border-radius:12px;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#111;font-weight:800;border:none;cursor:pointer;margin-top:14px;box-shadow:0 18px 50px rgba(255,138,41,0.12);transition:transform .18s, box-shadow .18s}
  .btn:hover{transform:translateY(-6px) scale(1.02)}
  .btn:active{transform:translateY(-2px)}

  /* right column */
  .side{position:sticky;top:24px}
  .rules-list{list-style:none;padding:0;margin:0}
  .rules-list li{padding:12px;border-radius:12px;margin-bottom:10px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.04));border:1px solid rgba(255,255,255,0.02)}

  /* welcome overlay */
  .welcome-overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg, rgba(10,6,4,0.98), rgba(10,6,4,0.94));z-index:9999;backdrop-filter: blur(4px)}
  .welcome-box{width:92%;max-width:900px;padding:34px;border-radius:18px;text-align:center;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));box-shadow:0 30px 100px rgba(0,0,0,0.7);border:1px solid rgba(255,255,255,0.02);position:relative;overflow:hidden}
  .welcome-logo{width:140px;height:140px;border-radius:18px;overflow:hidden;margin:0 auto 12px;border:6px solid rgba(255,138,41,0.06);display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--accent),var(--accent-2))}
  .welcome-logo img{width:90%;height:90%;object-fit:contain;display:block}
  .welcome-box h1{font-size:30px;margin:6px 0;color:var(--accent);letter-spacing:1px}
  .welcome-sub{color:var(--muted);margin-bottom:14px}
  .enter-btn{margin-top:12px;padding:12px 20px;border-radius:12px;border:none;background:linear-gradient(90deg,var(--accent),var(--accent-2));font-weight:800;color:#111;cursor:pointer;box-shadow:0 20px 60px rgba(255,138,41,0.12);transition:transform .18s}
  .enter-btn:hover{transform:translateY(-6px);filter:brightness(1.02)}

  /* logo animation */
  .logo-spin{animation:spin 6s linear infinite}
  @keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}

  /* small-screen */
  @media (max-width:980px){
    main{grid-template-columns:1fr; padding-bottom:40px}
    .side{position:relative;top:0}
    header{flex-direction:column;gap:10px}
    .welcome-box{padding:22px}
  }
  @media (max-width:420px){
    .welcome-box h1{font-size:22px}
    header h1{font-size:18px}
  }

  /* decorative glows & particles */
  .glow{position:absolute;border-radius:50%;filter:blur(36px);opacity:0.12;pointer-events:none}
  .glow.g1{width:420px;height:420px;background:radial-gradient(circle at 30% 30%, rgba(255,138,41,0.16), transparent);left:-120px;top:-120px}
  .glow.g2{width:360px;height:360px;background:radial-gradient(circle at 70% 70%, rgba(255,180,110,0.12), transparent);right:-90px;bottom:-100px}
</style>
</head>
<body>

<div class="welcome-overlay" id="welcome">
  <div class="welcome-box">
    <div class="welcome-logo logo-spin" aria-hidden="true">
      <img src="logo.webp" alt="Falcon Town Logo">
    </div>
    <h1>Ù…Ø±Ø­Ø¨Ø§ Ø¨Ùƒ ÙÙŠ ØªÙØ¹ÙŠÙ„ â€” Falcon Town</h1>
    <p class="welcome-sub">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø±Ø³Ù…ÙŠØ© â€” Ø§Ø¶ØºØ· Ø¯Ø®ÙˆÙ„ Ù„Ù„Ù…ØªØ§Ø¨Ø¹Ø©</p>
    <div style="display:flex;gap:12px;justify-content:center;align-items:center;margin-top:8px">
      <button class="enter-btn" id="enterSite">Ø¯Ø®ÙˆÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹</button>
      <button class="enter-btn" id="muteBtn" style="background:transparent;color:var(--accent);border:1px solid rgba(255,138,41,0.12)">ÙƒØªÙ… Ø§Ù„Ø£ØµÙˆØ§Øª</button>
    </div>
  </div>
</div>

<div class="container">
  <header>
    <div class="logo" aria-hidden="true"><img src="logo.webp" alt="logo"></div>
    <div class="brand">
      <h1>ØªÙØ¹ÙŠÙ„ - Falcon Town</h1>
      <p class="muted">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø±Ø³Ù…ÙŠØ© â€” ØµÙ…Ù…Ù‡Ø§ ÙƒØ§ÙØ­ Ø§Ù„Ù…ÙƒØ§ÙØ­</p>
      <nav style="margin-top:10px">
        <button class="nav-btn active" data-target="home">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</button>
        <button class="nav-btn" data-target="rules">Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„ØªÙØ¹ÙŠÙ„</button>
        <button class="nav-btn" data-target="apply">Ø·Ù„Ø¨ Ø§Ù„ØªÙØ¹ÙŠÙ„</button>
      </nav>
    </div>
  </header>

  <main>
    <section class="card hero section active" id="home">
      <div class="glow g1"></div>
      <div class="glow g2"></div>
      <h2>Ù…Ø±Ø­Ø¨Ù‹Ø§ ÙÙŠ Falcon Town</h2>
      <p class="muted">Ù‡Ù†Ø§ ØªØ¬Ø¯ ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ Ù„ØªÙØ¹ÙŠÙ„ Ø­Ø³Ø§Ø¨Ùƒ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±.</p>
      <div style="margin-top:16px" class="content">
        <p>Ø§Ø®ØªØ± Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø£Ø¹Ù„Ø§Ù‡ Ù„Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† ÙˆÙ†Ù…ÙˆØ°Ø¬ Ø·Ù„Ø¨ Ø§Ù„ØªÙØ¹ÙŠÙ„.</p>
        <p style="margin-top:12px;color:var(--muted)">Ù…Ø¤Ø«Ø±Ø§Øª ØµÙˆØªÙŠØ© ÙˆØ­Ø±ÙƒØ§Øª Ø¹Ù†Ø¯ Ø§Ù„ØªÙ†Ù‚Ù„ â€” Ø¬Ø±Ø¨Ù‡Ø§ Ø§Ù„Ø¢Ù†!</p>
      </div>
    </section>

    <aside class="card side" style="min-height:120px">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <strong>Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø³Ø±ÙŠØ¹Ø©</strong>
          <div class="muted" style="font-size:13px">Falcon Town</div>
        </div>
        <div style="text-align:left">
          <label style="font-size:13px;color:var(--muted)">Ø§Ù„Ø£ØµÙˆØ§Øª
            <input id="soundToggle" type="checkbox" checked style="margin-left:8px;transform:scale(1.1)">
          </label>
        </div>
      </div>

      <ul class="rules-list" style="margin-top:14px">
        <li>ğŸ“¢ ØªÙˆØ§ØµÙ„ Ø¹Ø¨Ø± Ù‚Ù†Ø§Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ÙÙŠ Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯.</li>
      </ul>
    </aside>

    <section class="card section" id="rules">
      <h2>Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„ØªÙØ¹ÙŠÙ„</h2>
      <div class="content muted" style="margin-top:10px">
        <ol>
          <li>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø¨Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙÙŠ Ø§Ù„Ø·Ù„Ø¨.</li>
          <li>ÙŠØ¬Ø¨ Ø°ÙƒØ± Ø³Ø¨Ø¨ Ù…Ù‚Ù†Ø¹ Ù„Ù„ØªÙØ¹ÙŠÙ„ â€” Ø§Ù„Ø·Ù„Ø¨Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ù‚Ù†Ø¹Ø© Ø³ØªÙØ±ÙØ¶.</li>
          <li>Ù„Ø§ ØªÙƒØ±Ø§Ø± ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨ Ø£ÙƒØ«Ø± Ù…Ù† Ù…Ø±Ø© ÙƒÙ„ 48 Ø³Ø§Ø¹Ø©.</li>
          <li>Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© ØªØ­ØªÙØ¸ Ø¨Ø§Ù„Ø­Ù‚ ÙÙŠ Ù‚Ø¨ÙˆÙ„ Ø£Ùˆ Ø±ÙØ¶ Ø£ÙŠ Ø·Ù„Ø¨.</li>
        </ol>
      </div>
    </section>

    <section class="card section" id="apply">
      <h2>Ø·Ù„Ø¨ ØªÙØ¹ÙŠÙ„</h2>
      <p class="muted">Ø§Ù…Ù„Ø£ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø£Ø¯Ù†Ø§Ù‡ Ø¨Ø¯Ù‚Ø© â€” ÙŠØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ø¹Ù„Ù‰ Ø´ÙƒÙ„ Embed Ø¥Ù„Ù‰ Ù‚Ù†Ø§Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.</p>
      <form id="activationForm" style="margin-top:14px">
        <label>Ø§Ø³Ù…Ùƒ ÙÙŠ Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯</label>
        <input type="text" name="user" placeholder="Ù…Ø«Ø§Ù„: Player#1234" required>

        <label>Ø¹Ù…Ø±Ùƒ</label>
        <input type="number" name="age" placeholder="Ù…Ø«Ø§Ù„: 18" required>

        <label>Ø³Ø¨Ø¨ ØªÙØ¹ÙŠÙ„Ùƒ</label>
        <textarea name="reason" placeholder="Ø§ÙƒØªØ¨ Ø³Ø¨Ø¨ Ù…Ù‚Ù†Ø¹ Ù‡Ù†Ø§..." required></textarea>
        <small style="display:block;color:var(--muted);margin-top:6px">Ø³Ø¨Ø¨ Ù…Ù‚Ù†Ø¹</small>

        <button class="btn" type="submit">Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨ Ø§Ù„ØªÙØ¹ÙŠÙ„</button>
        <div id="formStatus" class="muted" style="margin-top:10px"></div>
      </form>
    </section>
  </main>

  <footer style="margin-top:20px;text-align:center;color:var(--muted);font-size:13px">ØµÙ†Ø¹ Ø¨ÙˆØ§Ø³Ø·Ø© <strong>ÙƒØ§ÙØ­ Ø§Ù„Ù…ÙƒØ§ÙØ­</strong> â€” Falcon Town</footer>
</div>

<script>
/* ===========================
   ØµÙˆØªÙŠØ§Øª: WebAudio-based
   =========================== */
let audioEnabled = true;
const soundToggle = document.getElementById('soundToggle');
const muteBtn = document.getElementById('muteBtn');

soundToggle.addEventListener('change', e=> audioEnabled = e.target.checked);
muteBtn && muteBtn.addEventListener('click', ()=> {
  audioEnabled = !audioEnabled;
  soundToggle.checked = audioEnabled;
  // Ø¨ØµÙˆØª Ù‚ØµÙŠØ± ÙŠØ°ÙƒØ± Ø­Ø§Ù„Ø©
  microBeep(audioEnabled ? 880 : 200, 0.06);
});

/* create audio context and helper */
function _audioCtx(){
  return window.__audioCtx || (window.__audioCtx = new (window.AudioContext || window.webkitAudioContext)());
}
function playOsc(freq, type='sine', dur=0.08, gain=0.07){
  if(!audioEnabled) return;
  try{
    const ctx = _audioCtx();
    const o = ctx.createOscillator();
    const g = ctx.createGain();
    o.type = type; o.frequency.value = freq;
    g.gain.value = gain;
    o.connect(g); g.connect(ctx.destination);
    o.start();
    g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime + dur);
    setTimeout(()=>{ try{ o.stop(); }catch(e){} }, dur*1000 + 12);
  }catch(e){}
}

/* small effects */
function microBeep(f=720,d=0.04){ playOsc(f,'triangle',d,0.04) }
function clickSound(){ playOsc(760,'triangle',0.045,0.04) }
function navSound(){ playOsc(420,'sine',0.12,0.09) }
function successSound(){ playOsc(320,'sine',0.18,0.12); setTimeout(()=>playOsc(900,'sine',0.08,0.05),120) }
function errorSound(){ playOsc(160,'sawtooth',0.18,0.12); setTimeout(()=>playOsc(220,'sawtooth',0.12,0.06),150) }

/* ===========================
   Navigation & UI behaviors
   =========================== */
const navBtns = document.querySelectorAll('.nav-btn');
const sections = document.querySelectorAll('.section');
navBtns.forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const target = btn.dataset.target;
    // update active class
    navBtns.forEach(b=>b.classList.remove('active'));
    btn.classList.add('active');
    // show section
    sections.forEach(s=>{
      if(s.id === target){ s.classList.add('active'); } else { s.classList.remove('active'); }
    });
    navSound();
  });
});

/* welcome enter behavior */
const welcome = document.getElementById('welcome');
const enterBtn = document.getElementById('enterSite');
enterBtn.addEventListener('click', ()=>{
  // small animation: fade out overlay
  welcome.style.transition = 'opacity .6s, transform .6s';
  welcome.style.opacity = 0;
  welcome.style.transform = 'scale(.98) translateY(10px)';
  setTimeout(()=> welcome.remove(), 650);
  // sound
  successSound();
  // reveal home section
  document.querySelectorAll('.section').forEach(s=> s.classList.remove('active'));
  document.getElementById('home').classList.add('active');
  // focus first interactive element
  setTimeout(()=> { const el = document.querySelector('nav .nav-btn.active'); if(el) el.focus(); }, 700);
});

/* auto-hide welcome after 7s if not clicked */
setTimeout(()=> {
  if(document.getElementById('welcome')) {
    document.getElementById('welcome').style.opacity = 0;
    setTimeout(()=> { const el = document.getElementById('welcome'); if(el) el.remove(); }, 700);
  }
}, 7000);

/* small hover/click sound for buttons */
document.addEventListener('pointerdown', e=>{
  const t = e.target;
  if(t.closest('.nav-btn') || t.closest('.btn') || t.closest('.enter-btn')) clickSound();
});

/* keyboard accessibility for nav */
navBtns.forEach(b=> b.addEventListener('keyup', (e)=> { if(e.key==='Enter' || e.key===' ') b.click(); }));

/* ==========================================================
   Form handling & Webhook (ØªÙ… ØªØ­Ø¯ÙŠØ« Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù… Ù„Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© CORS)
   ========================================================== */
/* Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù‡Ù†Ø§ */
const WEBHOOK_URL = "https://discord.com/api/webhooks/1436031723682140182/2iD0pRybn7fMiKHw2y1jBZAVhLyEw11h78iUpoeiJ8Q-nxQcroweZRMfWtZS8Txzoc68";

/**
 * Ø¯Ø§Ù„Ø© Ø¨Ø³ÙŠØ·Ø© Ù„ØªÙ‡Ø±ÙŠØ¨ (Escape) Ø§Ù„Ù†ØµÙˆØµ Ù…Ù† HTML Ù„ØªØ¬Ù†Ø¨ Ù…Ø´Ø§ÙƒÙ„ Ø§Ù„Ø¹Ø±Ø¶.
 * @param {string} s Ø§Ù„Ù†Øµ Ø§Ù„Ù…Ø±Ø§Ø¯ ØªÙ‡Ø±ÙŠØ¨Ù‡.
 */
function escapeHtml(s){ 
  return (s+"").replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); 
}

/**
 * ØªØ±Ø³Ù„ Ø·Ù„Ø¨ Ø§Ù„Ù€ Embed Ø¥Ù„Ù‰ Webhook Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨Ø±ÙˆÙƒØ³ÙŠ Ù„ØªØ¬Ø§ÙˆØ² CORS.
 * @param {object} embed Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù€ Embed.
 */
async function sendEmbed(embed){
  // ğŸ”‘ Ø§Ù„Ø­Ù„ Ù„Ù…Ø´ÙƒÙ„Ø© CORS: Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ù†Ø·Ø§Ù‚ Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ Ø¨Ù†Ø·Ø§Ù‚ Ø¨Ø±ÙˆÙƒØ³ÙŠ Ù…ÙˆØ«ÙˆÙ‚ Ø¨Ù‡
  // Ù‡Ø°Ø§ Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ (lewisakura) Ù…ØµÙ…Ù… Ù„ØªØ¬Ø§ÙˆØ² Ù‚ÙŠÙˆØ¯ CORS Ø¹Ù„Ù‰ Webhooks Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯.
  const CORS_PROXY_DOMAIN = 'webhook.lewisakura.moe';
  
  // ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ 'discord.com' Ø£Ùˆ 'discordapp.com' Ø¨Ù†Ø·Ø§Ù‚ Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ
  const finalEndpoint = WEBHOOK_URL.replace(/(discord\.com|discordapp\.com)/, CORS_PROXY_DOMAIN);

  try{
    const res = await fetch(finalEndpoint, {
      method:'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({embeds:[embed]})
    });
    
    // ÙŠØ¬Ø¨ ÙØ­Øµ Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ù…Ù† Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ/Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
    if(!res.ok) {
        let errorBody = await res.text();
        console.error('Webhook Error Response:', errorBody);
        throw new Error(`Failed with status ${res.status}. Response: ${errorBody.substring(0, 100)}...`);
    }
    
    return {ok:true};
  }catch(err){
    console.warn('send failed (CORS likely solved, check network/proxy status)', err);
    return {ok:false, error:err.message};
  }
}

document.getElementById('activationForm').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const status = document.getElementById('formStatus');
  status.textContent = "Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨..."; navSound();
  const form = new FormData(e.target);
  const f = Object.fromEntries(form.entries());
  
  // ØªØ­Ù‚Ù‚ Ø¨Ø³ÙŠØ· Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
  if(!f.user || !f.age || !f.reason){
     status.textContent = "Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© âš ï¸";
     errorSound();
     return;
  }
  
  // build embed
  const embed = {
    title: `Ø·Ù„Ø¨ ØªÙØ¹ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ â€” ${f.user || 'â€”'}`,
    color: 15158332, // Ù„ÙˆÙ† Ø¨Ø±ØªÙ‚Ø§Ù„ÙŠ/Ø°Ù‡Ø¨ÙŠ
    fields: [
      { name: "ğŸ‘¤ Ø§Ù„Ø§Ø³Ù… ÙÙŠ Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯", value: escapeHtml(f.user) || "â€”", inline:true },
      { name: "ğŸ‚ Ø§Ù„Ø¹Ù…Ø±", value: escapeHtml(f.age) || "â€”", inline:true },
      { name: "ğŸ“ Ø³Ø¨Ø¨ Ø§Ù„ØªÙØ¹ÙŠÙ„", value: escapeHtml(f.reason) || "â€”", inline:false }
    ],
    timestamp: new Date().toISOString(),
    footer: { text: "ØªÙØ¹ÙŠÙ„ - Falcon Town" }
  };
  
  const result = await sendEmbed(embed);
  
  if(result.ok){
    status.textContent = "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­ âœ…";
    successSound();
    e.target.reset(); // ØªÙØ±ÙŠØº Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
  } else {
    // Ø¹Ø±Ø¶ Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ø£ÙƒØ«Ø± ØªÙØµÙŠÙ„Ø§Ù‹ ÙÙŠ Ø­Ø§Ù„Ø© ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ Ù„Ø£ÙŠ Ø³Ø¨Ø¨ Ø¢Ø®Ø± (Ù…Ø«Ù„ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ù†ÙØ³Ù‡)
    status.innerHTML = 'ÙØ´Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ (ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆÙŠØ¨ Ù‡ÙˆÙƒ Ø£Ùˆ Ø­Ø§Ù„Ø© Ø§Ù„Ø¨Ø±ÙˆÙƒØ³ÙŠ). Ø§Ù„Ø±Ø³Ø§Ù„Ø©: ' + escapeHtml(result.error);
    errorSound();
  }
});

/* On load: make sure home is active */
window.addEventListener('load', ()=>{
  document.querySelectorAll('.section').forEach(s=> s.classList.remove('active'));
  document.getElementById('home').classList.add('active');
  // random gentle micro beep to show UI alive (short)
  setTimeout(()=> microBeep(660,0.03), 400);
});
</script>
</body>
</html>
